<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chinamobile.hnu.xiangyu.social.dao.DynamicMapper">
	<resultMap id="BaseResultMap"
		type="com.chinamobile.hnu.xiangyu.social.pojo.Dynamic">
		<!-- WARNING - @mbg.generated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Thu May 17
			23:34:42 CST 2018. -->
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="date" jdbcType="DATE" property="date" />
		<result column="content" jdbcType="VARCHAR" property="content" />
		<result column="user_id" jdbcType="INTEGER" property="user_id" />
	</resultMap>

	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu May 17 
			23:34:42 CST 2018. -->
		date,localtion,content,user_id
	</sql>


	<insert id="insertDynamic" parameterType="com.chinamobile.hnu.xiangyu.social.pojo.Dynamic"
			useGeneratedKeys="true" keyProperty="id" >
		insert into social_dynamic (date,location,content,user_id)
		values (#{date,jdbcType=DATE},
		#{location,jdbcType=VARCHAR}, #{content,jdbcType=VARCHAR},
		 #{user_id,jdbcType=INTEGER})
	</insert>

	<insert id="insertPhoto">
		insert into social_dynamic_image (dynamic_id,image_route)
		values (#{dynamic_id,jdbcType=INTEGER},
			#{image_route,jdbcType=VARCHAR})
	</insert>

	<select id="getDynamic" parameterType="INTEGER" resultType="com.chinamobile.hnu.xiangyu.social.pojo.Dynamic">
		select id,date,location,content,user_id from social_dynamic
		where id=#{dynamic_id,jdbcType=INTEGER}
	</select>

	<select id="getPhotos" parameterType="INTEGER" resultType="String">
		select image_route from social_dynamic_image
		where dynamic_id=#{dynamic_id,jdbcType=INTEGER}
	</select>

    <insert id="insertLike" useGeneratedKeys="true">
		insert into social_dynamic_like (user_id,dynamic_id)
		values (#{user_id,jdbcType=INTEGER},#{dynamic_id,jdbcType=INTEGER})
	</insert>

    <select id="selectLike" parameterType="INTEGER" resultType="Integer">
		select user_id  from social_dynamic_like
		where  dynamic_id=#{dynamic_id,jdbcType=INTEGER}
	</select>

	<insert id="saveComment" parameterType="com.chinamobile.hnu.xiangyu.social.pojo.DynamicComment"
			useGeneratedKeys="true" keyProperty="id">
		insert into dynamic_comment(id,dynamic_id,presentor,content,gmt_create,type,critics)
		values (#{id,jdbcType=INTEGER},#{dynamic_id, jdbcType=INTEGER},#{presentor,jdbcType=INTEGER},#{content,jdbcType=
		VARCHAR},#{gmt_create,jdbcType=DATE},#{type,jdbcType=INTEGER},#{critics,jdbcType=INTEGER})
	</insert>

	<select id="getMyDynamic" parameterType="INTEGER" resultType="com.chinamobile.hnu.xiangyu.social.pojo.Dynamic">
		select id,date,location,content,user_id from social_dynamic
		where user_id=#{user_id,jdbcType=INTEGER}
	</select>

	<select id="selectById" parameterType="INTEGER" resultType="com.chinamobile.hnu.xiangyu.social.pojo.DynamicComment">
		select * from dynamic_comment
		where dynamic_id=#{dynamic_id,jdbcType=INTEGER}
	</select>

</mapper>