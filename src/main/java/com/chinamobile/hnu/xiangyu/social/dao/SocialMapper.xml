<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chinamobile.hnu.xiangyu.social.dao.SocialMapper">
	<resultMap id="BaseResultMap"
		type="com.chinamobile.hnu.xiangyu.social.pojo.Social">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu May 17 
			23:34:42 CST 2018. -->
		<id column="user_id" jdbcType="INTEGER" property="user_id" />
		<result column="telephone" jdbcType="CHAR" property="telephone" />
		<result column="birthday" jdbcType="DATE" property="birthday" />
		<result column="descroption" jdbcType="VARCHAR" property="descroption" />
		<result column="longitude" jdbcType="DOUBLE" property="longitude" />
		<result column="latitude" jdbcType="DOUBLE" property="latitude"/>
	</resultMap>

	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu May 17 
			23:34:42 CST 2018. -->
		user_id, telephone,birthday,descroption,distance
	</sql>


	<insert id="insert" parameterType="com.chinamobile.hnu.xiangyu.social.pojo.Social"
		 keyProperty="user_id">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu May 17 
			23:34:42 CST 2018. -->
		insert into social_user_info (user_id, telephone,birthday,descroption,longitude,latitude)
		values (#{user_id,jdbcType=INTEGER},
		#{telephone,jdbcType=CHAR}, #{birthday,jdbcType=DATE},
		 #{descroption,jdbcType=VARCHAR}, #{longitude,jdbcType=DOUBLE},#{latitude,jdbcType=DOUBLE})
	</insert>

	<select id="info" parameterType="int" resultType="com.chinamobile.hnu.xiangyu.social.vo.SocialVo">
		<!-- WARNING - @mbg.generated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Thu May 17
			23:34:42 CST 2018. -->
		select sex,realname,birthday,college,descroption,head from social_info
		where user_id=#{user_id}
	</select>

    <select id="isMyConcern"  resultType="int">
		select count(*) from follow
		where follower=#{user_id} and concerned=#{his_id}
	</select>

    <select id="myFollow" parameterType="int" resultType="int">
		select count(*) from follow
		where concerned=#{user_id}
	</select>

	<select id="getMyAlbum" parameterType="int" resultType="com.chinamobile.hnu.xiangyu.social.pojo.Photo">
		select id,user_id,image_route from social_photo_album
		where user_id=#{user_id}
	</select>

	<select id="getSameLabel"  resultType="Integer">
			select distinct user_id  from user_label where label in
			(select label from user_label where user_id=#{user_id})
	</select>

	<select id="selectByAge"  resultType="Integer">
			SELECT user_id  FROM social_user_info WHERE year( from_days( datediff( now( ), birthday))) BETWEEN #{min} AND #{max}
	</select>

	<select id="selectBySex"  resultType="Integer">
			SELECT user_id  FROM social_info where sex=#{sex}
	</select>

	<select id="selectByCollege"  resultType="Integer">
			SELECT user_id  FROM social_info where college=#{college}
	</select>
	<select id="getAll"  resultType="Integer">
			SELECT user_id  FROM social_user_info
	</select>


</mapper>